# í”„ë¡œì íŠ¸ ì „ë°˜ ë¶„ì„

## í”„ë¡œì íŠ¸ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| **í”„ë¡œì íŠ¸ëª…** | ëŒ€ë§Œë§›ì§‘ì •ë³´ (Taiwan Food Guide) |
| **ì €ì¥ì†Œ** | taiwan-food-nextjs |
| **ë°°í¬ URL** | https://taiwan-food-nextjs.vercel.app |
| **í”„ë ˆì„ì›Œí¬** | Next.js 16.1.4 (App Router) |
| **ì–¸ì–´** | TypeScript 5 |
| **ìŠ¤íƒ€ì¼ë§** | Tailwind CSS 4 |

## ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸

### í”„ë¡ íŠ¸ì—”ë“œ
```
Next.js 16.1.4
â”œâ”€â”€ React 19
â”œâ”€â”€ TypeScript 5
â”œâ”€â”€ Tailwind CSS 4
â”œâ”€â”€ Radix UI (shadcn/ui)
â”‚   â”œâ”€â”€ Dialog
â”‚   â”œâ”€â”€ Sheet
â”‚   â”œâ”€â”€ Tabs
â”‚   â”œâ”€â”€ ScrollArea
â”‚   â””â”€â”€ ...
â””â”€â”€ Lucide React (ì•„ì´ì½˜)
```

### ë°±ì—”ë“œ
```
Next.js API Routes
â”œâ”€â”€ MongoDB Atlas (ë°ì´í„°ë² ì´ìŠ¤)
â”œâ”€â”€ Cloudinary (ì´ë¯¸ì§€ ì €ì¥)
â”œâ”€â”€ JWT + bcryptjs (ì¸ì¦)
â”œâ”€â”€ Resend (ì´ë©”ì¼ ì¸ì¦)
â””â”€â”€ Google Places API (ì¥ì†Œ ì •ë³´)
```

### ì¸í”„ë¼
```
Vercel
â”œâ”€â”€ Serverless Functions
â”œâ”€â”€ Cron Jobs (ì¼ì¼ ë™ê¸°í™”)
â”œâ”€â”€ Edge Network (CDN)
â””â”€â”€ Auto Deploy (GitHub ì—°ë™)
```

## í•µì‹¬ íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/           # API ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ auth/      # ì¸ì¦ (ë¡œê·¸ì¸, íšŒì›ê°€ì…, ì´ë©”ì¼ì¸ì¦)
â”‚   â”‚   â”œâ”€â”€ cron/      # Cron Jobs (ë¦¬ë·° ê°±ì‹ , í¸ì˜ì  ë™ê¸°í™”)
â”‚   â”‚   â”œâ”€â”€ reviews/   # ë¦¬ë·° CRUD
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ globals.css    # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ layout.tsx     # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â””â”€â”€ page.tsx       # ë©”ì¸ SPA
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/            # shadcn/ui ê¸°ë°˜
â”‚   â”œâ”€â”€ toilet-finder.tsx    # í™”ì¥ì‹¤ ì°¾ê¸°
â”‚   â”œâ”€â”€ restaurant-history.tsx # ë“±ë¡ íˆìŠ¤í† ë¦¬
â”‚   â””â”€â”€ *.tsx          # ë¹„ì¦ˆë‹ˆìŠ¤ ì»´í¬ë„ŒíŠ¸
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ taiwan-food.ts # ë§›ì§‘ ì •ì  ë°ì´í„°
â”‚
â””â”€â”€ lib/
    â”œâ”€â”€ mongodb.ts     # DB ì—°ê²°
    â”œâ”€â”€ district-utils.ts # ì§€ì—­(êµ¬) ìœ í‹¸ë¦¬í‹° (extractRegion, normalizeRegion, DISTRICT_INFO)
    â”œâ”€â”€ types.ts       # íƒ€ì… ì •ì˜
    â””â”€â”€ utils.ts       # ìœ í‹¸ë¦¬í‹°
```

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ê´€ê³„

```
page.tsx (ë©”ì¸ í˜ì´ì§€)
â”‚
â”œâ”€â”€ í—¤ë”
â”‚   â”œâ”€â”€ AuthModal (ë¡œê·¸ì¸/íšŒì›ê°€ì…)
â”‚   â””â”€â”€ ì‚¬ìš©ì ë©”ë‰´
â”‚       â”œâ”€â”€ ë“±ë¡ íˆìŠ¤í† ë¦¬
â”‚       â”œâ”€â”€ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
â”‚       â””â”€â”€ íšŒì›íƒˆí‡´
â”‚
â”œâ”€â”€ í™ˆ í™”ë©´
â”‚   â”œâ”€â”€ ê²€ìƒ‰ë°” (ìë™ì™„ì„±)
â”‚   â”œâ”€â”€ íƒ€ì´ë² ì´ ì—¬í–‰ ê°€ì´ë“œ ë²„íŠ¼ (guide view)
â”‚   â”œâ”€â”€ í™”ì¥ì‹¤ ì°¾ê¸° ë²„íŠ¼
â”‚   â”œâ”€â”€ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼
â”‚   â”œâ”€â”€ ì¸ê¸° ë§›ì§‘ (RestaurantCard)
â”‚   â”œâ”€â”€ ì§€ì—­ë³„ ë§›ì§‘ ë­í‚¹ (districtRanking)
â”‚   â””â”€â”€ ì•¼ì‹œì¥ë³„ ë§›ì§‘ (RestaurantCard)
â”‚
â”œâ”€â”€ íƒ€ì´ë² ì´ ì—¬í–‰ ê°€ì´ë“œ (guide view)
â”‚   â”œâ”€â”€ íƒ€ì´ë² ì´ì‹œ vs ì‹ ë² ì´ì‹œ ì†Œê°œ
â”‚   â”œâ”€â”€ íƒ€ì´ë² ì´ì‹œ 12ê°œ êµ¬ ì„¤ëª…
â”‚   â”œâ”€â”€ íƒ€ì´ë² ì´ì‹œ ì£¼ìš” ëª…ì†Œ
â”‚   â””â”€â”€ ì‹ ë² ì´ì‹œ ì£¼ìš” ëª…ì†Œ
â”‚
â”œâ”€â”€ ì§€ì—­ë³„ ë§›ì§‘ ë­í‚¹ (district-ranking view)
â”‚   â””â”€â”€ ì „ì²´ ì§€ì—­ ë­í‚¹ ì¹´ë“œ ëª©ë¡
â”‚
â”œâ”€â”€ í™”ì¥ì‹¤ ì°¾ê¸° (ToiletFinder)
â”‚   â”œâ”€â”€ 7-ELEVEN íƒ­
â”‚   â””â”€â”€ FamilyMart íƒ­
â”‚
â”œâ”€â”€ ë“±ë¡ íˆìŠ¤í† ë¦¬ (RestaurantHistoryList)
â”‚
â”œâ”€â”€ ëª©ë¡ í™”ë©´ (RestaurantList)
â”‚   â””â”€â”€ RestaurantCard
â”‚
â”œâ”€â”€ ìƒì„¸ í™”ë©´ (RestaurantDetail)
â”‚   â””â”€â”€ ReviewSection
â”‚       â””â”€â”€ ReviewModal
â”‚
â”œâ”€â”€ BottomNav (ë„¤ë¹„ê²Œì´ì…˜)
â”‚
â””â”€â”€ CategorySheet (ë°”í…€ ì‹œíŠ¸ ëª¨ë‹¬)
```

## API ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½

| ë©”ì„œë“œ | ê²½ë¡œ | ì„¤ëª… |
|--------|------|------|
| POST | /api/auth/register | íšŒì›ê°€ì… |
| POST | /api/auth/login | ë¡œê·¸ì¸ |
| POST | /api/auth/logout | ë¡œê·¸ì•„ì›ƒ |
| GET | /api/auth/me | í˜„ì¬ ì‚¬ìš©ì |
| POST | /api/auth/send-verification | ì´ë©”ì¼ ì¸ì¦ ì½”ë“œ ë°œì†¡ |
| POST | /api/auth/verify-email | ì´ë©”ì¼ ì¸ì¦ í™•ì¸ |
| POST | /api/auth/change-password | ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ |
| DELETE | /api/auth/delete-account | ê³„ì • ì‚­ì œ |
| GET/POST | /api/reviews | ë¦¬ë·° ëª©ë¡/ì‘ì„± |
| PUT/DELETE | /api/reviews/[id] | ë¦¬ë·° ìˆ˜ì •/ì‚­ì œ |
| POST | /api/upload | ì´ë¯¸ì§€ ì—…ë¡œë“œ |
| GET | /api/place-photo | Google ì´ë¯¸ì§€ í”„ë¡ì‹œ |
| GET/POST/PUT/PATCH/DELETE | /api/custom-restaurants | ì‚¬ìš©ì ë§›ì§‘ CRUD |
| GET/POST | /api/restaurant-history | ë“±ë¡ íˆìŠ¤í† ë¦¬ |
| POST | /api/ratings | ì‹¤ì‹œê°„ í‰ì  ì¡°íšŒ |
| GET | /api/seven-eleven-toilet | 7-ELEVEN í™”ì¥ì‹¤ ê²€ìƒ‰ |
| GET | /api/familymart-toilet | FamilyMart í™”ì¥ì‹¤ ê²€ìƒ‰ |
| GET | /api/cron/refresh-reviews | ë¦¬ë·° ì •ë³´ ê°±ì‹  (Cron) |
| GET | /api/cron/sync-seven-eleven | 7-ELEVEN ë™ê¸°í™” (Cron) |
| GET | /api/cron/sync-familymart | FamilyMart ë™ê¸°í™” (Cron) |

## ë°ì´í„° ì¹´í…Œê³ ë¦¬

### ìŒì‹ ì¹´í…Œê³ ë¦¬ (11ê°œ)
- ì „ì²´, ë©´ë¥˜, ë°¥ë¥˜, ë§Œë‘, ìš°ìœ¡íƒ•, í› ê¶ˆ
- ë””ì €íŠ¸, ê¸¸ê±°ë¦¬, ì¹´í˜, ê³µì°¨, ê¹Œë¥´í‘¸

### ì•¼ì‹œì¥ (6ê°œ)
- ìŠ¤ë¦°, ë‹ìƒ¤, ë¼ì˜¤í—ˆì œ, í†µí™”, í‘ì, ë‹¨ìˆ˜ì´

### ë„ì‹¬íˆ¬ì–´ (4ê°œ)
- ì‹œë¨¼ë”©, ìœµìº‰ì œ, ì¤‘ì‚°, ì‹ ì´

## MongoDB ì»¬ë ‰ì…˜

| ì»¬ë ‰ì…˜ | ì„¤ëª… |
|--------|------|
| users | ì‚¬ìš©ì ê³„ì • |
| reviews | ì‚¬ìš©ì ë¦¬ë·° |
| custom_restaurants | ì‚¬ìš©ì ë“±ë¡ ë§›ì§‘ |
| restaurant_history | ë§›ì§‘ ë“±ë¡/ìˆ˜ì •/ì‚­ì œ íˆìŠ¤í† ë¦¬ |
| email_verifications | ì´ë©”ì¼ ì¸ì¦ ì½”ë“œ |
| seven_eleven_toilets | 7-ELEVEN í™”ì¥ì‹¤ ë§¤ì¥ (íƒ€ì´ë² ì´+ì‹ ë² ì´) |
| familymart_stores | FamilyMart ë§¤ì¥ (íƒ€ì´ë² ì´+ì‹ ë² ì´) |

## Vercel Cron Jobs

| ìŠ¤ì¼€ì¤„ | ê²½ë¡œ | ì„¤ëª… |
|--------|------|------|
| ë§¤ì¼ 06:00 UTC | /api/cron/refresh-reviews | Google ë¦¬ë·° ì •ë³´ ê°±ì‹  |
| ë§¤ì¼ 22:00 UTC | /api/cron/sync-seven-eleven | 7-ELEVEN ë§¤ì¥ ë™ê¸°í™” |
| ë§¤ì¼ 23:00 UTC | /api/cron/sync-familymart | FamilyMart ë§¤ì¥ ë™ê¸°í™” |

## í™˜ê²½ë³€ìˆ˜

```env
# MongoDB
MONGODB_URI=mongodb+srv://...
MONGODB_DB_NAME=taiwan_food

# Cloudinary
CLOUDINARY_URL=cloudinary://...

# JWT
JWT_SECRET=...

# Google Places
GOOGLE_PLACES_API_KEY=...

# Resend (ì´ë©”ì¼)
RESEND_API_KEY=re_...

# Cron (Vercel)
CRON_SECRET=...

# Admin
ADMIN_SECRET_KEY=...
```

## ìµœê·¼ ë³€ê²½ì‚¬í•­

### 2025-01-24
- **ì§€ì—­ë³„ ë§›ì§‘ ë­í‚¹ ê¸°ëŠ¥ ì¶”ê°€**
  - í™ˆí™”ë©´ì— "ğŸ“ ì§€ì—­ë³„ ë§›ì§‘ ë­í‚¹" ì„¹ì…˜ ì¶”ê°€
  - íƒ€ì´ë² ì´ 12ê°œ êµ¬ + ì‹ ë² ì´ì‹œ ì§€ì—­ë³„ í‰ê·  í‰ì  ê³„ì‚°
  - ìƒìœ„ 5ê°œ ì§€ì—­ ë©”ë‹¬ í‘œì‹œ (ğŸ¥‡ğŸ¥ˆğŸ¥‰)
  - "ë”ë³´ê¸°" í´ë¦­ ì‹œ ì „ì²´ ì§€ì—­ ë­í‚¹ í‘œì‹œ (district-ranking view)
  - ì§€ì—­ í´ë¦­ ì‹œ í•´ë‹¹ ì§€ì—­ ë§›ì§‘ ëª©ë¡ í‘œì‹œ
- **íƒ€ì´ë² ì´ ì—¬í–‰ ê°€ì´ë“œ í˜ì´ì§€ ì¶”ê°€** (guide view)
  - íƒ€ì´ë² ì´ì‹œ vs ì‹ ë² ì´ì‹œ ì†Œê°œ
  - íƒ€ì´ë² ì´ì‹œ 12ê°œ êµ¬ ì„¤ëª… (ì´ëª¨ì§€ í¬í•¨)
  - íƒ€ì´ë² ì´ì‹œ ì£¼ìš” ëª…ì†Œ 7ê³³
  - ì‹ ë² ì´ì‹œ ì£¼ìš” ëª…ì†Œ 8ê³³
  - MZì„¸ëŒ€ ì¹œí™”ì  UI (ê·¸ë¼ë°ì´ì…˜, ë‘¥ê·¼ ì¹´ë“œ)
- **ë„¤ë¹„ê²Œì´ì…˜ íˆìŠ¤í† ë¦¬ ìŠ¤íƒ ê´€ë¦¬**
  - previousView ë‹¨ì¼ ë³€ìˆ˜ â†’ viewHistory ë°°ì—´(ìŠ¤íƒ)ìœ¼ë¡œ ë³€ê²½
  - ì—¬ëŸ¬ ë‹¨ê³„ ì´ë™ í›„ì—ë„ ì •í™•í•œ ë’¤ë¡œê°€ê¸° ì§€ì›
- **í™”ì¥ì‹¤ ì°¾ê¸° í™”ë©´ UX ê°œì„ **
  - "ë‹«ê¸°" ë²„íŠ¼ â†’ ë’¤ë¡œê°€ê¸° ë²„íŠ¼ìœ¼ë¡œ í†µì¼
  - ì•± ì „ì²´ ë„¤ë¹„ê²Œì´ì…˜ ì¼ê´€ì„± í™•ë³´
- **district-utils.ts ìœ í‹¸ë¦¬í‹° íŒŒì¼ ë¶„ë¦¬**
  - extractRegion, normalizeRegion, DISTRICT_INFO í•¨ìˆ˜ ë¶„ë¦¬
  - getRestaurantDistrict, isValidDistrict í•¨ìˆ˜ ì¶”ê°€

### 2025-01-21
- ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ìµœì‹  ë²„ì „ ì—…ë°ì´íŠ¸
  - Next.js 16.1.4
  - @types/node 25.0.9
  - cloudinary 2.9.0
  - resend 6.8.0
- ë§›ì§‘ ìƒì„¸ í™”ë©´ ë°ì´í„° ë™ê¸°í™” ê°œì„ 
  - ìƒì„¸ í™”ë©´ ì§„ì… ì‹œ DBì—ì„œ ìµœì‹  ë°ì´í„° ìë™ fetch
  - ìˆ˜ì • í›„ onUpdate ì½œë°±ìœ¼ë¡œ ë¶€ëª¨ ìƒíƒœ ì‹¤ì‹œê°„ ë°˜ì˜
- ë“±ë¡ íˆìŠ¤í† ë¦¬ ë’¤ë¡œê°€ê¸° ë²„ê·¸ ìˆ˜ì •
- Restaurant íƒ€ì…ì— ì‚¬ìš©ì ë“±ë¡ ë§›ì§‘ í•„ë“œ ì¶”ê°€
- ë§›ì§‘ ë“±ë¡ ì¹´í…Œê³ ë¦¬ì— ê¹Œë¥´í‘¸ ì¶”ê°€

### 2025-01-20
- 7-ELEVEN í™”ì¥ì‹¤ ì°¾ê¸° ê¸°ëŠ¥ ì¶”ê°€
- FamilyMart í™”ì¥ì‹¤ ì°¾ê¸° ê¸°ëŠ¥ ì¶”ê°€
- íƒ€ì´ë² ì´ì‹œ + ì‹ ë² ì´ì‹œ 41ê°œ êµ¬ ì§€ì›
- MongoDB ê¸°ë°˜ í¸ì˜ì  ë°ì´í„° ìºì‹±
- Vercel Cron Jobìœ¼ë¡œ ì¼ì¼ ìë™ ë™ê¸°í™”

### 2025-01-18
- ë§›ì§‘ ë“±ë¡ íˆìŠ¤í† ë¦¬ ê¸°ëŠ¥ ì¶”ê°€
- íˆìŠ¤í† ë¦¬ì—ì„œ ë§›ì§‘ ìƒì„¸ í™”ë©´ ì´ë™

## ê°œë°œ ëª…ë ¹ì–´

```bash
# ê°œë°œ ì„œë²„
npm run dev

# ë¹Œë“œ
npm run build

# ë¦°íŠ¸
npm run lint

# í”„ë¡œë•ì…˜
npm start
```

## ë°°í¬ ë°©ë²•

```bash
# GitHubì— í‘¸ì‹œí•˜ë©´ ìë™ ë°°í¬
git add .
git commit -m "feat: ê¸°ëŠ¥ ì„¤ëª…"
git push origin main
```

## ê´€ë ¨ ë¬¸ì„œ

- [README.md](../docs/README.md) - í”„ë¡œì íŠ¸ ê°œìš”
- [ARCHITECTURE.md](../docs/ARCHITECTURE.md) - ì•„í‚¤í…ì²˜
- [TROUBLESHOOTING.md](../docs/TROUBLESHOOTING.md) - ë¬¸ì œ í•´ê²°
- [FEATURES.md](../docs/FEATURES.md) - ê¸°ëŠ¥ ëª…ì„¸
- [API.md](../docs/API.md) - API ëª…ì„¸

## Cursor/Claude ì—°ë™ íŒ

### ì½”ë“œ ê²€ìƒ‰
```
"ê²€ìƒ‰ ê¸°ëŠ¥" â†’ src/app/page.tsx (searchRestaurants)
"ë¦¬ë·° ì‘ì„±" â†’ src/components/review-modal.tsx
"ì¸ì¦" â†’ src/app/api/auth/
"í™”ì¥ì‹¤" â†’ src/components/toilet-finder.tsx
"í¸ì˜ì  ë™ê¸°í™”" â†’ src/app/api/cron/
```

### ìì£¼ ìˆ˜ì •í•˜ëŠ” íŒŒì¼
- `src/app/page.tsx` - ë©”ì¸ í˜ì´ì§€ ë¡œì§ (ë·° ê´€ë¦¬, ë„¤ë¹„ê²Œì´ì…˜)
- `src/data/taiwan-food.ts` - ë§›ì§‘ ë°ì´í„°
- `src/lib/district-utils.ts` - ì§€ì—­(êµ¬) ìœ í‹¸ë¦¬í‹°
- `src/components/ui/sheet.tsx` - ëª¨ë‹¬ ìŠ¤íƒ€ì¼
- `src/components/toilet-finder.tsx` - í™”ì¥ì‹¤ ì°¾ê¸°
- `src/components/restaurant-list.tsx` - ë§›ì§‘ ëª©ë¡ (ì§€ì—­ë³„ ê·¸ë£¹í™”)
