// 대만 맛집 데이터
export interface Restaurant {
  이름: string;
  위치: string;
  특징: string;
  야시장?: string;
  평점?: number;
  리뷰수?: number;
}

export interface TaiwanFoodData {
  면류: Restaurant[];
  만두: Restaurant[];
  밥류: Restaurant[];
  디저트: Restaurant[];
  길거리음식: Restaurant[];
  카페: Restaurant[];
  "갈만한 곳": Restaurant[];
  야시장별: Record<string, string[]>;
  도심투어: Record<string, Restaurant[]>;
}

export const taiwanFoodMap: TaiwanFoodData = {
  "면류": [
    {"이름": "아종면선", "위치": "타이베이 시먼딩", "특징": "걸쭉한 국물의 면선으로 유명한 맛집", "평점": 4.5, "리뷰수": 12500},
    {"이름": "용캉우육면", "위치": "타이베이 용캉제", "특징": "진한 국물의 우육면 전문점", "평점": 4.6, "리뷰수": 8900}
  ],
  "만두": [
    {"이름": "딩타이펑", "위치": "타이베이 신이", "특징": "세계적으로 유명한 샤오롱바오 전문점", "평점": 4.7, "리뷰수": 45000},
    {"이름": "융캉제 딩타이펑", "위치": "타이베이 융캉제", "특징": "융캉제에 위치한 딩타이펑 지점", "평점": 4.6, "리뷰수": 18000}
  ],
  "밥류": [
    {"이름": "진삼십 루로우판", "위치": "타이베이 중산", "특징": "루로우판 전문점, 진하고 달콤한 간장 돼지고기 덮밥", "평점": 4.4, "리뷰수": 6200},
    {"이름": "금봉 루로우판", "위치": "타이베이 중산구", "특징": "미슐랭 빕구르망 선정, 현지인이 사랑하는 루로우판", "평점": 4.5, "리뷰수": 9800},
    {"이름": "후지산 루로우판", "위치": "타이베이 시먼딩", "특징": "시먼딩 대표 루로우판 맛집, 짭조름하고 고소한 맛", "평점": 4.3, "리뷰수": 5400},
    {"이름": "마이 루로우판", "위치": "타이베이 융캉제", "특징": "융캉제 인기 루로우판, 부드러운 삼겹살 조림", "평점": 4.2, "리뷰수": 3200},
    {"이름": "자이 지로우판", "위치": "타이베이 중정구", "특징": "자이 스타일 닭고기덮밥, 담백하고 고소한 닭기름 소스", "평점": 4.1, "리뷰수": 2800},
    {"이름": "류지아 지로우판", "위치": "타이베이 중산구", "특징": "현지인 추천 지로우판, 잘게 찢은 닭고기와 특제 소스", "평점": 4.3, "리뷰수": 4100},
    {"이름": "민성 지로우판", "위치": "타이베이 민성", "특징": "50년 전통 지로우판 맛집, 부드러운 닭고기", "평점": 4.4, "리뷰수": 5600},
    {"이름": "콩로우판 전문점", "위치": "타이베이 닝샤", "특징": "큼직한 오겹살 찜 덮밥, 든든한 한 끼", "평점": 4.0, "리뷰수": 1800},
    {"이름": "타이베이역 비엔당", "위치": "타이베이역", "특징": "대만 철도 도시락, 파이구판(돼지갈비 덮밥) 유명", "평점": 4.2, "리뷰수": 7500},
    {"이름": "푸항 또우장", "위치": "타이베이 다안구", "특징": "퐌투안(대만식 주먹밥)과 또우장 아침 전문점", "평점": 4.5, "리뷰수": 11000},
    {"이름": "아랑 기름밥", "위치": "타이베이 중산구", "특징": "여우판(기름밥) 전문, 찹쌀에 표고버섯과 돼지고기", "평점": 4.1, "리뷰수": 2400},
    {"이름": "닝샤 미까오", "위치": "타이베이 닝샤 야시장", "특징": "찹쌀을 원통형으로 쪄낸 미까오, 찰진 식감", "야시장": "닝샤 야시장", "평점": 4.0, "리뷰수": 1500},
    {"이름": "스린 퐌투안", "위치": "타이베이 스린", "특징": "대만식 주먹밥, 요우티아오와 러우쑹이 들어간 든든한 아침", "평점": 4.2, "리뷰수": 3800},
    {"이름": "영강 파이구판", "위치": "타이베이 융캉제", "특징": "바삭한 돼지갈비 덮밥, 특제 양념이 일품", "평점": 4.3, "리뷰수": 4500},
    {"이름": "철판볶음밥 전문", "위치": "타이베이 시먼딩", "특징": "대만식 철판볶음밥, 다양한 토핑 선택 가능", "평점": 4.0, "리뷰수": 2100}
  ],
  "디저트": [
    {"이름": "스무시 하우스", "위치": "타이베이 스린", "특징": "유명한 망고빙수 전문점", "평점": 4.4, "리뷰수": 8200},
    {"이름": "아이메이 홍두빙", "위치": "단수이", "특징": "유명한 팥빙수 전문점", "야시장": "단수이 야시장", "평점": 4.3, "리뷰수": 5600},
    {"이름": "스린뻐 또우화", "위치": "Jihe Rd", "특징": "대만식 두부 디저트", "야시장": "스린 야시장", "평점": 4.2, "리뷰수": 3400},
    {"이름": "우유튀김", "위치": "Jihe Rd, 7-1號", "특징": "튀긴 우유", "야시장": "스린 야시장", "평점": 4.1, "리뷰수": 2800},
    {"이름": "샤오황 따빠처우", "위치": "스린야시장 내", "특징": "고구마볼", "야시장": "스린 야시장", "평점": 4.0, "리뷰수": 1900},
    {"이름": "류유지 타로볼 튀김", "위치": "타이베이 닝샤 야시장 91번 노점", "특징": "미슐랭 추천, 바삭하고 고소한 타로볼 튀김", "야시장": "닝샤 야시장", "평점": 4.5, "리뷰수": 7800},
    {"이름": "고구마볼", "위치": "타이베이 닝샤 야시장 초입 2번 노점", "특징": "오리지널, 치즈, 초콜릿 등 다양한 맛의 고구마볼", "야시장": "닝샤 야시장", "평점": 4.2, "리뷰수": 4100},
    {"이름": "대만식 우유튀김", "위치": "타이중 펑자 야시장 Wenhua Rd", "특징": "겉은 바삭, 속은 부드러운 디저트", "야시장": "펑자 야시장", "평점": 4.1, "리뷰수": 2500},
    {"이름": "타로볼 튀김", "위치": "타이중 펑자 야시장 초입", "특징": "미슐랭 추천 간식으로 유명한 고소한 타로볼", "야시장": "펑자 야시장", "평점": 4.4, "리뷰수": 5200}
  ],
  "길거리음식": [
    {"이름": "하오따따 지파이", "위치": "Jihe Rd, Shilin District", "특징": "대왕 지파이 (닭가슴살 튀김)", "야시장": "스린 야시장", "평점": 4.4, "리뷰수": 15000},
    {"이름": "왕자 치즈감자", "위치": "No. 1, Jihe Rd", "특징": "치즈감자", "야시장": "스린 야시장", "평점": 4.2, "리뷰수": 6800},
    {"이름": "충성호 굴전", "위치": "Dadong Rd, Shilin District", "특징": "굴전, 오아첸", "야시장": "스린 야시장", "평점": 4.3, "리뷰수": 8500},
    {"이름": "아훼이 면선", "위치": "스린야시장 내", "특징": "대만식 면선 (곱창국수)", "야시장": "스린 야시장", "평점": 4.1, "리뷰수": 4200},
    {"이름": "위엔화볜 굴전", "위치": "타이베이 닝샤 야시장 59번 부근", "특징": "현지인 강추, 굴이 풍부하고 촉촉한 굴 오믈렛", "야시장": "닝샤 야시장", "평점": 4.4, "리뷰수": 6200},
    {"이름": "지파이", "위치": "타이베이 닝샤 야시장 78번 노점", "특징": "대왕 지파이 (닭가슴살 튀김), 바삭한 튀김과 촉촉한 속살", "야시장": "닝샤 야시장", "평점": 4.2, "리뷰수": 3500},
    {"이름": "샹창 찹쌀 소세지", "위치": "타이베이 닝샤 야시장 59-2번 노점", "특징": "찹쌀과 소세지의 조화, 든든한 간식", "야시장": "닝샤 야시장", "평점": 4.0, "리뷰수": 2100},
    {"이름": "오징어튀김", "위치": "타이베이 닝샤 야시장 89번 노점", "특징": "바다향 가득, 바삭한 식감", "야시장": "닝샤 야시장", "평점": 4.1, "리뷰수": 2800},
    {"이름": "구운 옥수수", "위치": "타이중 펑자 야시장", "특징": "5가지 맛 선택 가능 (오리지널, 후추, 매운맛 등) 무지개 옥수수 구이", "야시장": "펑자 야시장", "평점": 4.3, "리뷰수": 4800},
    {"이름": "밍룬 계란 팬케이크", "위치": "타이중 펑자 야시장 Fuxing Rd 546번", "특징": "바삭한 대만식 계란 팬케이크와 다양한 속재료", "야시장": "펑자 야시장", "평점": 4.2, "리뷰수": 3600},
    {"이름": "1번 닭날개 볶음밥", "위치": "타이중 펑자 야시장 펑자 대학교 근처", "특징": "닭날개 속에 밥이 들어간 독특한 간식", "야시장": "펑자 야시장", "평점": 4.1, "리뷰수": 2400},
    {"이름": "펑자 지파이", "위치": "타이중 펑자 야시장 중심부", "특징": "바삭하고 촉촉한 대왕 닭가슴살 튀김", "야시장": "펑자 야시장", "평점": 4.3, "리뷰수": 5100}
  ],
  "카페": [
    // 중산(Zhongshan) & 다퉁 구역 - 트렌디한 카페 거리
    {"이름": "커피 스위트", "위치": "타이베이 중산구 중산역", "특징": "미니멀한 인테리어와 수준 높은 핸드드립으로 유명한 스페셜티 커피 전문점", "평점": 4.6, "리뷰수": 3200},
    {"이름": "미스 V 베이커리", "위치": "타이베이 중산구 츠펑가", "특징": "시나몬 롤과 브런치로 유명, 현지 MZ세대의 성지", "평점": 4.5, "리뷰수": 8500},
    {"이름": "멜로우 커피", "위치": "타이베이 중산구", "특징": "복고풍 분위기에서 정성스러운 커피를 맛볼 수 있는 카페", "평점": 4.4, "리뷰수": 2100},
    {"이름": "유지 차방", "위치": "타이베이 다퉁구", "특징": "100년 넘은 전통 찻집, 대만 우롱차의 역사를 느낄 수 있으며 선물용 차 구매 추천", "평점": 4.7, "리뷰수": 4800},

    // 다안(Da'an) & 융캉제 구역 - 깊이 있는 차 문화
    {"이름": "카페 리베로", "위치": "타이베이 융캉제", "특징": "융캉제의 터줏대감, 고택을 개조한 곳으로 밤에는 바로 변신. 카푸치노 유명", "평점": 4.5, "리뷰수": 6200},
    {"이름": "샤오미죠", "위치": "타이베이 다안구", "특징": "조용한 분위기의 라떼 아트 맛집, 독서하거나 작업하기 좋은 카페", "평점": 4.3, "리뷰수": 1800},
    {"이름": "청전차관", "위치": "타이베이 다안구 청전가", "특징": "일본식 목조 가옥에서 즐기는 품격 있는 다도 체험, 정원이 아름다운 찻집", "평점": 4.8, "리뷰수": 5600},
    {"이름": "소다재", "위치": "타이베이 다안구", "특징": "현대적인 감각으로 대만차를 해석, 젊은 층에게 인기 있는 모던 찻집", "평점": 4.4, "리뷰수": 2900},

    // 신이(Xinyi) 구역 - 화려한 전망과 프리미엄 커피
    {"이름": "심플 카파 솔라", "위치": "타이베이 101 빌딩 88층", "특징": "월드 바리스타 챔피언의 커피를 구름 위에서 즐기는 프리미엄 카페 (예약 필수)", "평점": 4.9, "리뷰수": 12000},
    {"이름": "% 아라비카", "위치": "타이베이 신이구 샹산", "특징": "심플한 디자인과 고소한 라떼로 유명, 항상 대기 줄이 있는 인기 카페", "평점": 4.5, "리뷰수": 9800},
    {"이름": "트로포 커피", "위치": "타이베이 신이구", "특징": "세련된 인테리어와 함께 스페셜티 커피의 진수를 보여주는 카페", "평점": 4.6, "리뷰수": 3400},

    // 중정(Zhongzheng) 구역 - 월드 챔피언의 본진
    {"이름": "심플 카파 플래그십", "위치": "타이베이 중정구 화산 1914", "특징": "세계 최고의 카페로 선정된 곳, 다크 브라운 슈가 라떼가 시그니처 메뉴", "평점": 4.8, "리뷰수": 15000},
    {"이름": "페이퍼 스트리트 커피", "위치": "타이베이 중정구 화산 1914 맞은편", "특징": "탁 트인 창밖 풍경을 보며 진한 커피를 즐기기 좋은 카페", "평점": 4.4, "리뷰수": 2600},

    // 완화(Wanhua) 구역 - 타이베이의 어제와 오늘
    {"이름": "펑따 커피", "위치": "타이베이 완화구 시먼딩", "특징": "1956년 오픈한 타이베이 최고(最古) 카페, 사이폰 커피와 대만식 전통 과자의 특별한 조합", "평점": 4.6, "리뷰수": 7200}
  ],
  "갈만한 곳": [
    {"이름": "단수이", "위치": "신베이시 단수이구", "특징": "강가의 아름다운 해안 도시, 유명한 옛 거리와 맛집들이 많음", "야시장": "단수이 야시장"},
    {"이름": "고양이마을 (후투엔)", "위치": "신베이시 루이팡구", "특징": "고양이들이 자유롭게 돌아다니는 아기자기한 마을"},
    {"이름": "지우펀", "위치": "신베이시 루이팡구", "특징": "구릉 지대에 위치한 작은 산골마을, 카페와 갤러리가 많음"},
    {"이름": "예류", "위치": "신베이시 완리구", "특징": "해안 절벽과 바위로 유명한 경관 명소"},
    {"이름": "스펀", "위치": "신베이시 루이팡구", "특징": "물이 뿜어나오는 특별한 지질 현상으로 유명"},
    {"이름": "용산사", "위치": "타이베이시 베이터우구", "특징": "타이베이 최고의 절, 아름다운 중국식 건축물"},
    {"이름": "중정기념당", "위치": "타이베이시 중정구", "특징": "타이완의 상징적인 건물, 넓은 광장과 아름다운 정원"},
    {"이름": "융캉제", "위치": "타이베이시 다안구", "특징": "전통 대만 거리, 맛집과 쇼핑거리가 많은 번화가"},
    {"이름": "고궁박물관", "위치": "타이베이시 스린구", "특징": "세계 최대 규모의 중국 미술품 컬렉션"},
    {"이름": "타이베이 근교 온천", "위치": "타이베이시 베이터우구/신베이시", "특징": "베이터우, 지룽 등 근교에 위치한 유명 온천 지역"},
    {"이름": "타이베이 101", "위치": "타이베이시 신이구", "특징": "타이베이의 랜드마크, 전망대와 쇼핑몰"}
  ],
  "야시장별": {
    "스린 야시장": ["하오따따 지파이", "왕자 치즈감자", "충성호 굴전", "우유튀김", "아훼이 면선", "스린뻐 또우화", "샤오황 따빠처우", "스린 퐌투안"],
    "닝샤 야시장": ["류유지 타로볼 튀김", "위엔화볜 굴전", "지파이", "고구마볼", "샹창 찹쌀 소세지", "오징어튀김", "닝샤 미까오"],
    "펑자 야시장": ["대만식 우유튀김", "타로볼 튀김", "구운 옥수수", "밍룬 계란 팬케이크", "1번 닭날개 볶음밥", "펑자 지파이"],
    "단수이 야시장": ["아이메이 홍두빙"],
    "라오허제 야시장": [],
    "난지창 야시장": []
  },
  "도심투어": {
    "시먼딩": [
      {"이름": "아종면선", "위치": "타이베이 시먼딩", "특징": "걸쭉한 국물의 면선으로 유명한 맛집"},
      {"이름": "행복당", "위치": "타이베이 시먼딩", "특징": "유명한 타로 밀크티와 팥빙수 전문 디저트 찻집"},
      {"이름": "삼형제빙수", "위치": "타이베이 시먼딩", "특징": "망고빙수 맛집, 시먼딩 대표 빙수집"},
      {"이름": "스무시 하우스 시먼딩점", "위치": "타이베이 시먼딩", "특징": "유명한 망고빙수 전문점"},
      {"이름": "시먼딩 펑차", "위치": "타이베이 시먼딩", "특징": "유명한 펄 밀크티 전문점"},
      {"이름": "시먼딩 차관", "위치": "타이베이 시먼딩", "특징": "전통 대만 찻집, 우롱차와 철관음 전문"},
      {"이름": "천천빙", "위치": "타이베이 시먼딩", "특징": "대만 전통 찻집, 빙수와 디저트도 판매"},
      {"이름": "시먼카페", "위치": "타이베이 시먼딩", "특징": "트렌디한 카페, 인스타 감성 사진 명소"},
      {"이름": "스타벅스 시먼딩점", "위치": "타이베이 시먼딩", "특징": "쇼핑 중 휴식하기 좋은 카페"}
    ],
    "융캉제": [
      {"이름": "용캉우육면", "위치": "타이베이 용캉제", "특징": "진한 국물의 우육면 전문점"},
      {"이름": "융캉제 딩타이펑", "위치": "타이베이 융캉제", "특징": "유명한 샤오롱바오 전문점"},
      {"이름": "옐로우 커피", "위치": "타이베이 융캉제", "특징": "브런치와 커피가 유명한 카페"}
    ],
    "중산카페거리": [
      {"이름": "VWI by CHADWANG", "위치": "타이베이 중산", "특징": "유명한 브런치 카페"},
      {"이름": "Fika Fika Cafe", "위치": "타이베이 중산", "특징": "원두 로스팅 전문 카페"},
      {"이름": "Congrats Cafe", "위치": "타이베이 중산", "특징": "예쁜 디저트와 커피가 유명한 카페"}
    ],
    "중정기념당": [
      {"이름": "춘수당", "위치": "타이베이 중정기념당", "특징": "버블티(펄밀크티) 원조 브랜드, 1983년 타이중에서 시작된 대만 대표 찻집"},
      {"이름": "중정기념당", "위치": "타이베이시 중정구", "특징": "타이완의 상징적인 건물, 넓은 광장과 아름다운 정원"}
    ]
  }
};

// 카테고리 정보
export const categories = [
  { id: "전체", name: "전체", icon: "🍽️" },
  { id: "면류", name: "면류", icon: "🍜" },
  { id: "밥류", name: "밥류", icon: "🍚" },
  { id: "만두", name: "만두", icon: "🥟" },
  { id: "디저트", name: "디저트", icon: "🍧" },
  { id: "길거리음식", name: "길거리", icon: "🍢" },
  { id: "카페", name: "카페", icon: "☕" },
];

// 야시장 정보
export const markets = [
  { id: "전체", name: "전체", icon: "🌙" },
  { id: "스린 야시장", name: "스린", icon: "🏮" },
  { id: "닝샤 야시장", name: "닝샤", icon: "🏮" },
  { id: "펑자 야시장", name: "펑자", icon: "🏮" },
  { id: "단수이 야시장", name: "단수이", icon: "🏮" },
];

// 도심투어 지역
export const tourAreas = [
  { id: "전체", name: "전체", icon: "🏙️" },
  { id: "시먼딩", name: "시먼딩", icon: "🛍️" },
  { id: "융캉제", name: "융캉제", icon: "☕" },
  { id: "중산카페거리", name: "중산카페", icon: "🍰" },
  { id: "중정기념당", name: "중정기념당", icon: "🏛️" },
];

// 유틸리티 함수
export function getAllRestaurants(): Restaurant[] {
  const all: Restaurant[] = [];
  const cats = ["면류", "만두", "밥류", "디저트", "길거리음식", "카페"] as const;
  for (const cat of cats) {
    all.push(...taiwanFoodMap[cat]);
  }
  return all;
}

export function getRestaurantsByCategory(category: string): Restaurant[] {
  if (category === "전체") {
    return getAllRestaurants();
  }
  return taiwanFoodMap[category as keyof typeof taiwanFoodMap] as Restaurant[] || [];
}

export function getRestaurantsByMarket(market: string): Restaurant[] {
  const allRestaurants: Record<string, Restaurant> = {};
  const cats = ["면류", "만두", "밥류", "디저트", "길거리음식", "카페"] as const;

  for (const cat of cats) {
    for (const rest of taiwanFoodMap[cat]) {
      allRestaurants[rest.이름] = rest;
    }
  }

  if (market === "전체") {
    const items: Restaurant[] = [];
    const seen = new Set<string>();

    for (const marketName of Object.keys(taiwanFoodMap.야시장별)) {
      const names = taiwanFoodMap.야시장별[marketName] || [];
      for (const name of names) {
        if (!seen.has(name)) {
          seen.add(name);
          items.push(allRestaurants[name] || { 이름: name, 위치: "", 특징: "", 야시장: marketName });
        }
      }
    }
    return items;
  }

  const names = taiwanFoodMap.야시장별[market] || [];
  return names.map(name => allRestaurants[name] || { 이름: name, 위치: "", 특징: "", 야시장: market });
}

export function getRestaurantsByTour(area: string): Restaurant[] {
  if (area === "전체") {
    const items: Restaurant[] = [];
    const seen = new Set<string>();

    for (const areaName of Object.keys(taiwanFoodMap.도심투어)) {
      const restaurants = taiwanFoodMap.도심투어[areaName] || [];
      for (const rest of restaurants) {
        if (!seen.has(rest.이름)) {
          seen.add(rest.이름);
          items.push(rest);
        }
      }
    }
    return items;
  }

  return taiwanFoodMap.도심투어[area] || [];
}

export function getPlaces(): Restaurant[] {
  return taiwanFoodMap["갈만한 곳"];
}

// 인기 맛집 (카테고리별 최고 평점 맛집 1개씩)
export function getPopularRestaurants(): Restaurant[] {
  const cats = ["면류", "만두", "밥류", "디저트", "길거리음식", "카페"] as const;
  const topByCategory: Restaurant[] = [];

  for (const cat of cats) {
    const items = taiwanFoodMap[cat];
    if (items && items.length > 0) {
      // 각 카테고리에서 평점이 가장 높은 맛집 선택
      const sorted = [...items]
        .filter((r) => r.평점)
        .sort((a, b) => (b.평점 || 0) - (a.평점 || 0));
      if (sorted.length > 0) {
        topByCategory.push(sorted[0]);
      }
    }
  }

  return topByCategory;
}

// 이미지 URL 생성 (Lorem Picsum 사용)
export function getUnsplashImage(name: string): string {
  // 이름 해시로 고유 시드 생성 (같은 이름은 항상 같은 이미지)
  const seed = name.split("").reduce((a, c) => a + c.charCodeAt(0), 0);
  return `https://picsum.photos/seed/${seed}/400/300`;
}

// 구글 맵 링크 생성
export function getGoogleMapsLink(name: string, location: string): string {
  let query = name || "";
  if (location && !location.includes("야시장")) {
    query += " " + location;
  }
  query += " Taipei Taiwan";
  return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query.trim())}`;
}
